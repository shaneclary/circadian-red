/**
 * Circadian Red - True circadian-safe red light mode
 * @license MIT
 * @author Shane Clary
 *
 * Based on melanopsin sensitivity research and Pollack's structured water science
 * Eliminates 446-477nm wavelengths that suppress melatonin and destroy EZ water
 */

/* ==========================================================================
   CircadianSafe Mode - Strict Implementation
   Pure RGB(255,0,0) with zero blue/green channels
   Maximum contrast: 5.25:1 (WCAG AA compliant)
   Target intensity: <3 lux at eye position
   ========================================================================== */

[data-circadian-mode="safe"] {
  /* Color Palette - Pure Red Spectrum Only */
  --cr-bg-primary: rgb(0, 0, 0);
  --cr-bg-secondary: rgb(15, 0, 0);
  --cr-bg-tertiary: rgb(25, 0, 0);
  --cr-bg-elevated: rgb(35, 0, 0);

  --cr-text-primary: rgb(255, 0, 0);      /* Maximum brightness - headings, key text */
  --cr-text-secondary: rgb(200, 0, 0);    /* Body text, standard content */
  --cr-text-tertiary: rgb(150, 0, 0);     /* Metadata, captions */
  --cr-text-disabled: rgb(80, 0, 0);      /* Disabled UI elements */
  --cr-text-subtle: rgb(100, 0, 0);       /* Borders, dividers */

  --cr-accent: rgb(255, 0, 0);
  --cr-accent-hover: rgb(220, 0, 0);
  --cr-accent-active: rgb(180, 0, 0);

  --cr-border: rgb(100, 0, 0);
  --cr-border-subtle: rgb(50, 0, 0);

  --cr-focus: rgb(255, 0, 0);
  --cr-focus-outline: 0 0 0 3px rgba(255, 0, 0, 0.3);

  /* Base styles */
  background-color: var(--cr-bg-primary) !important;
  color: var(--cr-text-secondary) !important;
}

[data-circadian-mode="safe"] * {
  /* Force red spectrum on all elements */
  color: inherit !important;
  border-color: var(--cr-border) !important;
}

[data-circadian-mode="safe"] a {
  color: var(--cr-text-primary) !important;
  text-decoration: underline;
}

[data-circadian-mode="safe"] a:hover {
  color: var(--cr-accent-hover) !important;
}

[data-circadian-mode="safe"] h1,
[data-circadian-mode="safe"] h2,
[data-circadian-mode="safe"] h3,
[data-circadian-mode="safe"] h4,
[data-circadian-mode="safe"] h5,
[data-circadian-mode="safe"] h6 {
  color: var(--cr-text-primary) !important;
  font-weight: 600;
}

[data-circadian-mode="safe"] button,
[data-circadian-mode="safe"] input,
[data-circadian-mode="safe"] textarea,
[data-circadian-mode="safe"] select {
  background-color: var(--cr-bg-secondary) !important;
  color: var(--cr-text-primary) !important;
  border: 1px solid var(--cr-border) !important;
}

[data-circadian-mode="safe"] button:hover {
  background-color: var(--cr-bg-tertiary) !important;
}

[data-circadian-mode="safe"] button:active {
  background-color: var(--cr-bg-elevated) !important;
}

[data-circadian-mode="safe"] button:focus,
[data-circadian-mode="safe"] input:focus,
[data-circadian-mode="safe"] textarea:focus,
[data-circadian-mode="safe"] select:focus {
  outline: none !important;
  box-shadow: var(--cr-focus-outline) !important;
}

[data-circadian-mode="safe"] ::selection {
  background-color: rgb(100, 0, 0) !important;
  color: rgb(255, 0, 0) !important;
}

/* Image filtering - convert to red spectrum */
[data-circadian-mode="safe"] img,
[data-circadian-mode="safe"] video,
[data-circadian-mode="safe"] canvas,
[data-circadian-mode="safe"] svg {
  filter: saturate(0) brightness(0.7) sepia(100%) hue-rotate(-50deg) !important;
}

/* Prevent white flashes during page load */
[data-circadian-mode="safe"] * {
  transition: background-color 0s, color 0s !important;
}

/* ==========================================================================
   RedMode (Relaxed) - Practical Implementation
   Allows some warmth for better usability
   Still eliminates most circadian-disruptive wavelengths
   Target intensity: <5 lux
   ========================================================================== */

[data-circadian-mode="relaxed"] {
  --cr-bg-primary: rgb(20, 8, 0);
  --cr-bg-secondary: rgb(30, 12, 0);
  --cr-bg-tertiary: rgb(40, 16, 0);
  --cr-bg-elevated: rgb(50, 20, 0);

  --cr-text-primary: rgb(255, 150, 100);
  --cr-text-secondary: rgb(255, 180, 130);
  --cr-text-tertiary: rgb(200, 120, 80);
  --cr-text-disabled: rgb(120, 60, 30);

  --cr-accent: rgb(255, 140, 80);
  --cr-border: rgb(100, 50, 25);

  background-color: var(--cr-bg-primary) !important;
  color: var(--cr-text-secondary) !important;
}

[data-circadian-mode="relaxed"] h1,
[data-circadian-mode="relaxed"] h2,
[data-circadian-mode="relaxed"] h3 {
  color: var(--cr-text-primary) !important;
}

[data-circadian-mode="relaxed"] a {
  color: var(--cr-accent) !important;
}

/* ==========================================================================
   Intensity Levels
   Adjust overall brightness for different environments
   ========================================================================== */

[data-circadian-intensity="high"] {
  /* 3 lux - maximum safe intensity */
  filter: brightness(1.0);
}

[data-circadian-intensity="medium"] {
  /* 1.5 lux - recommended default */
  filter: brightness(0.7);
}

[data-circadian-intensity="low"] {
  /* 0.5 lux - very dark environments */
  filter: brightness(0.4);
}

/* ==========================================================================
   Utility Classes
   ========================================================================== */

.cr-text-primary {
  color: var(--cr-text-primary) !important;
}

.cr-text-secondary {
  color: var(--cr-text-secondary) !important;
}

.cr-text-tertiary {
  color: var(--cr-text-tertiary) !important;
}

.cr-bg-primary {
  background-color: var(--cr-bg-primary) !important;
}

.cr-bg-secondary {
  background-color: var(--cr-bg-secondary) !important;
}

.cr-border {
  border-color: var(--cr-border) !important;
}

/* ==========================================================================
   Accessibility Enhancements
   Compensate for monochromatic limitations
   ========================================================================== */

[data-circadian-mode] {
  /* Enhance hierarchy through size and spacing */
  line-height: 1.6;
  letter-spacing: 0.01em;
}

[data-circadian-mode] h1 { font-size: 2.5em; margin: 1em 0 0.5em; }
[data-circadian-mode] h2 { font-size: 2em; margin: 0.9em 0 0.4em; }
[data-circadian-mode] h3 { font-size: 1.5em; margin: 0.8em 0 0.3em; }
[data-circadian-mode] p { margin: 0.75em 0; }

/* Increase touch targets */
[data-circadian-mode] button,
[data-circadian-mode] a {
  min-height: 44px;
  padding: 12px 16px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

/* Enhanced focus indicators */
[data-circadian-mode] *:focus-visible {
  outline: 3px solid var(--cr-focus) !important;
  outline-offset: 2px !important;
}

/* ==========================================================================
   Mode Toggle Component Styles
   ========================================================================== */

.circadian-mode-selector {
  display: inline-flex;
  border-radius: 8px;
  background: var(--cr-bg-secondary, #1a1a1a);
  padding: 2px;
  gap: 2px;
}

.circadian-mode-selector button {
  padding: 8px 16px;
  border: none;
  background: transparent;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
}

.circadian-mode-selector button[data-active="true"] {
  background: var(--cr-accent, #ff0000);
  box-shadow: 0 2px 8px rgba(255, 0, 0, 0.2);
}

.circadian-mode-selector button:hover {
  background: var(--cr-bg-tertiary, #2a2a2a);
}

/* ==========================================================================
   Print Styles
   Disable circadian mode for printing
   ========================================================================== */

@media print {
  [data-circadian-mode] {
    filter: none !important;
  }

  [data-circadian-mode] * {
    color: black !important;
    background: white !important;
  }
}

/* ==========================================================================
   Reduced Motion
   Respect user preferences
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  [data-circadian-mode] * {
    animation: none !important;
    transition: none !important;
  }
}
